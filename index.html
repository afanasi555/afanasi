<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê—Ñ–∞–Ω–∞—Å—å–µ–≤ –∑–∞–∏–≥—Ä—ã—à</title>
    <style>
        .game-board {
            display: grid;
            grid-template-columns: repeat(8, 50px);
            grid-gap: 2px;
            margin: 20px;
        }
        .cell {
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            border: 1px solid #ccc;
            cursor: pointer;
        }
        .shop, .inventory, .stats {
            display: none;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            padding: 20px;
            background: #fff;
            border: 1px solid #ddd;
            box-shadow: 0px 0px 10px rgba(0,0,0,0.5);
        }
        .close-button {
            position: absolute;
            top: 10px;
            right: 10px;
            cursor: pointer;
            font-size: 20px;
        }
    </style>
</head>
<body>
    <h1>–ê—Ñ–∞–Ω–∞—Å—å–µ–≤ –∑–∞–∏–≥—Ä—ã—à</h1>
    <div id="coins">–ú–æ–Ω–µ—Ç—ã: 0</div>
    <div id="moves">–•–æ–¥–æ–≤: 20</div>
    <div id="task-list"></div>
    <div class="game-board"></div>
    <button onclick="openShop()">üõçÔ∏è –ú–∞–≥–∞–∑–∏–Ω</button>
    <button onclick="openInventory()">üì¶ –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</button>
    <button onclick="openStats()">üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</button>
    <button onclick="startGame()">–ù–∞—á–∞—Ç—å –∏–≥—Ä—É</button>
    <button onclick="pauseGame()">–ü–∞—É–∑–∞</button>
    <button onclick="resetGame()">–°–±—Ä–æ—Å–∏—Ç—å</button>
    <button onclick="undoMove()">–û—Ç–º–µ–Ω–∏—Ç—å —Ö–æ–¥</button>

    <!-- –ú–∞–≥–∞–∑–∏–Ω -->
    <div class="shop">
        <span class="close-button" onclick="closeShop()">‚úñ</span>
        <h2>–ú–∞–≥–∞–∑–∏–Ω</h2>
        <button onclick="buyBomb()">–ö—É–ø–∏—Ç—å –±–æ–º–±—É (40 –º–æ–Ω–µ—Ç)</button>
        <button onclick="buyMove()">–ö—É–ø–∏—Ç—å —Ö–æ–¥ (1 –º–æ–Ω–µ—Ç–∞)</button>
    </div>

    <!-- –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å -->
    <div class="inventory">
        <span class="close-button" onclick="closeInventory()">‚úñ</span>
        <h2>–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</h2>
        <div id="inventory-content"></div>
    </div>

    <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
    <div class="stats">
        <span class="close-button" onclick="closeStats()">‚úñ</span>
        <h2>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
        <div id="stats-content"></div>
    </div>

    <script>
        let moves = 20;
        let coins = 0;
        let currentLevel = 1;
        let tasks = [{ emoji: "üçì", count: 3 }]; // –°–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ —É—Ä–æ–≤–Ω—è
        let selectedCell = null; // –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤—ã–±—Ä–∞–Ω–Ω–æ–π —è—á–µ–π–∫–∏
        let inventory = []; // –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∫—É–ø–ª–µ–Ω–Ω—ã—Ö –±–æ–º–±

        function startGame() {
            alert('–ò–≥—Ä–∞ –Ω–∞—á–∞–ª–∞—Å—å!');
            generateBoard();
            updateMoves();
        }

        function pauseGame() {
            alert('–ò–≥—Ä–∞ –Ω–∞ –ø–∞—É–∑–µ.');
        }

        function resetGame() {
            alert('–ò–≥—Ä–∞ –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω–∞!');
            generateBoard();
            updateMoves();
        }

        function undoMove() {
            alert('–•–æ–¥ –æ—Ç–º–µ–Ω–µ–Ω.');
        }

        function openShop() {
            document.querySelector('.shop').style.display = 'block';
        }

        function closeShop() {
            document.querySelector('.shop').style.display = 'none';
        }

        function openInventory() {
            document.querySelector('.inventory').style.display = 'block';
            updateInventory();
        }

        function closeInventory() {
            document.querySelector('.inventory').style.display = 'none';
        }

        function openStats() {
            let statsString = "–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–≥—Ä–æ–∫–æ–≤:\n";
            // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Ä–µ–∞–ª—å–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
            document.getElementById('stats-content').textContent = statsString;
            document.querySelector('.stats').style.display = 'block';
        }

        function closeStats() {
            document.querySelector('.stats').style.display = 'none';
        }

        function selectLevel(level) {
            if (level > currentLevel) {
                alert('–≠—Ç–æ—Ç —É—Ä–æ–≤–µ–Ω—å –ø–æ–∫–∞ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω.');
                return;
            }
            currentLevel = level;
            alert(`–í—ã –≤—ã–±—Ä–∞–ª–∏ —É—Ä–æ–≤–µ–Ω—å ${level}`);
            loadLevel(level);
        }

        function loadLevel(level) {
            moves = 20 + level * 5;  // –ü—Ä–∏–º–µ—Ä —É–≤–µ–ª–∏—á–µ–Ω–∏—è —à–∞–≥–æ–≤ —Å –∫–∞–∂–¥—ã–º —É—Ä–æ–≤–Ω–µ–º
            tasks = generateTasksForLevel(level);  // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–∞–¥–∞—á
            updateTaskList();
            generateBoard();  // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–≥—Ä–æ–≤–æ–≥–æ –ø–æ–ª—è
            updateMoves();
        }

        function generateTasksForLevel(level) {
            let taskList = [];
            if (level >= 5) {
                taskList.push({ emoji: "üçì", count: 5 });
                taskList.push({ emoji: "üçí", count: 4 });
            } else {
                taskList.push({ emoji: "üçì", count: 3 + level });
            }
            return taskList;
        }

        function updateTaskList() {
            let taskListDiv = document.getElementById("task-list");
            taskListDiv.innerHTML = "";
            tasks.forEach((task, index) => {
                taskListDiv.innerHTML += `<p class="task-item">–ó–∞–¥–∞—á–∞ ${index + 1}: –°–æ–±—Ä–∞—Ç—å ${task.count} ${task.emoji}</p>`;
            });
        }

        function generateBoard() {
            let board = document.querySelector('.game-board');
            board.innerHTML = "";  // –û—á–∏—â–∞–µ–º –ø–æ–ª–µ
            for (let i = 0; i < 64; i++) {
                let cell = document.createElement('div');
                cell.className = 'cell';
                cell.textContent = getRandomEmoji();  // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞
                cell.addEventListener('click', () => selectCell(cell, i));  // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–±—ã—Ç–∏—è –¥–ª—è –∫–ª–∏–∫–∞
                board.appendChild(cell);
            }
            // –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π –ø–æ—Å–ª–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–æ–ª—è
            setTimeout(() => {
                checkMatches();  // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è
                refillBoard();  // –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—É—Å—Ç—ã—Ö –º–µ—Å—Ç –Ω–æ–≤—ã–º–∏ –æ–±—ä–µ–∫—Ç–∞–º–∏
            }, 500);
        }

        function getRandomEmoji() {
            const emojis = ["‚≠ê", "‚ú®", "üí¶", "üî•", "üéâ", "‚ù§Ô∏è", "üçì", "üçí", "üçâ", "üçï", "üê±", "üêØ"];
            return emojis[Math.floor(Math.random() * emojis.length)];
        }

        function selectCell(cell, index) {
            if (selectedCell === null) {
                selectedCell = { element: cell, index: index };
                cell.style.border = '2px solid red';  // –í—ã–¥–µ–ª—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é —è—á–µ–π–∫—É
            } else {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –º–æ–∂–Ω–æ –ª–∏ –ø–æ–º–µ–Ω—è—Ç—å –º–µ—Å—Ç–∞–º–∏ —Å –≤—ã–±—Ä–∞–Ω–Ω–æ–π —è—á–µ–π–∫–æ–π
                if (isAdjacent(selectedCell.index, index)) {
                    swapCells(selectedCell.element, cell);  // –ú–µ–Ω—è–µ–º –º–µ—Å—Ç–∞–º–∏ —è—á–µ–π–∫–∏
                    moves--;
                    updateMoves();
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —Ö–æ–¥–∞
                    setTimeout(() => {
                        checkMatches();  // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è
                        refillBoard();  // –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—É—Å—Ç—ã—Ö –º–µ—Å—Ç –Ω–æ–≤—ã–º–∏ –æ–±—ä–µ–∫—Ç–∞–º–∏
                    }, 500);
                }
                selectedCell.element.style.border = '1px solid #ccc';  // –£–±–∏—Ä–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ
                selectedCell = null;  // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é —è—á–µ–π–∫—É
            }
        }

        function isAdjacent(index1, index2) {
            const row1 = Math.floor(index1 / 8);
            const col1 = index1 % 8;
            const row2 = Math.floor(index2 / 8);
            const col2 = index2 % 8;
            return (Math.abs(row1 - row2) + Math.abs(col1 - col2)) === 1;
        }

        function swapCells(cell1, cell2) {
            const temp = cell1.textContent;
            cell1.textContent = cell2.textContent;
            cell2.textContent = temp;
        }

        function checkMatches() {
            let board = document.querySelectorAll('.cell');
            let matchedCells = [];
            let toCheck = [];
            let index;

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã—Ö –∏ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã—Ö —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π
            for (let i = 0; i < 64; i++) {
                const row = Math.floor(i / 8);

                // –ü—Ä–æ–≤–µ—Ä
