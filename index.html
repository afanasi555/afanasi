<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢—Ä–∏ –≤ —Ä—è–¥</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0;
            background-color: #f0f0f0;
        }
        .board {
            display: grid;
            grid-template-columns: repeat(8, 50px);
            grid-gap: 5px;
            margin-top: 20px;
        }
        .cell {
            width: 50px;
            height: 50px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 24px;
            background-color: #ffffff;
            border: 1px solid #ddd;
            cursor: pointer;
        }
        .shop {
            margin-top: 20px;
            background-color: #ffffff;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        .shop button {
            padding: 10px;
            margin: 5px;
            font-size: 16px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <h1>–¢—Ä–∏ –≤ —Ä—è–¥</h1>

    <!-- –ò–≥—Ä–æ–≤–æ–µ –ø–æ–ª–µ -->
    <div class="board" id="board">
        <!-- –ö–ª–µ—Ç–∫–∏ –∏–≥—Ä–æ–≤–æ–≥–æ –ø–æ–ª—è –±—É–¥—É—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è —Å –ø–æ–º–æ—â—å—é JavaScript -->
    </div>

    <!-- –ú–∞–≥–∞–∑–∏–Ω -->
    <div class="shop">
        <h2>üõçÔ∏è –ú–∞–≥–∞–∑–∏–Ω</h2>
        <p>–í–∞—à–∏ –º–æ–Ω–µ—Ç—ã: <span id="coins">0</span> üåï</p>
        <button onclick="buyItem('bomb')">–ö—É–ø–∏—Ç—å –ë–æ–º–±—É üí£ - 40 –º–æ–Ω–µ—Ç</button>
        <button onclick="buyItem('move')">–ö—É–ø–∏—Ç—å —Ö–æ–¥ ‚ûï - 1 –º–æ–Ω–µ—Ç–∞</button>
    </div>

    <script>
        const objects = ['‚≠ê', '‚ú®', 'üí¶', 'üî•', 'üéâ', '‚ù§Ô∏è', 'üß°', 'üíõ'];
        let coins = 0;

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è WebApp
        const tg = window.Telegram.WebApp;
        tg.expand(); // –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å WebApp –Ω–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω

        // –ü–æ–ª—É—á–µ–Ω–∏–µ –º–æ–Ω–µ—Ç –æ—Ç –±–æ—Ç–∞
        tg.onEvent('mainButtonClicked', () => {
            tg.MainButton.setText("–ó–∞–≥—Ä—É–∑–∫–∞...");
            tg.sendData('coins_request');
        });

        tg.onEvent('webAppData', (data) => {
            const userData = JSON.parse(data);
            coins = userData.coins;
            document.getElementById('coins').innerText = coins;
            tg.MainButton.hide();
        });

        function generateBoard(size) {
            const board = [];
            for (let i = 0; i < size; i++) {
                const row = [];
                for (let j = 0; j < size; j++) {
                    row.push(objects[Math.floor(Math.random() * objects.length)]);
                }
                board.push(row);
            }
            return board;
        }

        function renderBoard(board) {
            const boardElement = document.getElementById('board');
            boardElement.innerHTML = '';
            board.forEach((row, i) => {
                row.forEach((cell, j) => {
                    const cellElement = document.createElement('div');
                    cellElement.classList.add('cell');
                    cellElement.textContent = cell;
                    cellElement.addEventListener('click', () => handleCellClick(i, j));
                    boardElement.appendChild(cellElement);
                });
            });
        }

        function handleCellClick(x, y) {
            alert(`–í—ã –Ω–∞–∂–∞–ª–∏ –Ω–∞ –∫–ª–µ—Ç–∫—É (${x}, ${y})`);
        }

        function buyItem(item) {
            if (item === 'bomb' && coins >= 40) {
                coins -= 40;
                alert('–í—ã –∫—É–ø–∏–ª–∏ –±–æ–º–±—É!');
            } else if (item === 'move' && coins >= 1) {
                coins -= 1;
                alert('–í—ã –∫—É–ø–∏–ª–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ö–æ–¥!');
            } else {
                alert('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç!');
            }
            document.getElementById('coins').innerText = coins;

            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –æ–±—Ä–∞—Ç–Ω–æ –±–æ—Ç—É
            tg.sendData(JSON.stringify({item, coins}));
        }

        // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º –∏–≥—Ä–æ–≤–æ–µ –ø–æ–ª–µ
        const board = generateBoard(8);
        renderBoard(board);

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–æ–Ω–µ—Ç –≤ –º–∞–≥–∞–∑–∏–Ω–µ
        document.getElementById('coins').innerText = coins;
    </script>
</body>
</html>
